<?xml version="1.0" encoding="UTF-8"?>
<con:soapui-project id="da9c23c0-0bee-4e1a-ab29-3561e8884413" activeEnvironment="Default" name="uklocation" resourceRoot="" soapui-version="5.3.0" xmlns:con="http://eviware.com/soapui/config"><con:settings/><con:interface xsi:type="con:WsdlInterface" id="90e8f66e-7462-4c40-986e-93c9118756c2" wsaVersion="NONE" name="UKLocationSoap" type="wsdl" bindingName="{http://www.webserviceX.NET}UKLocationSoap" soapVersion="1_1" anonymous="optional" definition="http://www.webservicex.net/uklocation.asmx?WSDL" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:settings/><con:definitionCache/><con:endpoints><con:endpoint>http://www.webservicex.net/uklocation.asmx</con:endpoint></con:endpoints><con:operation id="0df29ff5-5c4c-494a-9b15-345c6ef7e5db" isOneWay="false" action="http://www.webserviceX.NET/GetUKLocationByCounty" name="GetUKLocationByCounty" bindingOperationName="GetUKLocationByCounty" type="Request-Response" inputName="" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="2ef9433c-be78-42d6-b6e2-f2ce3ad4a603" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://www.webservicex.net/uklocation.asmx</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:web="http://www.webserviceX.NET">\r
   <soapenv:Header/>\r
   <soapenv:Body>\r
      <web:GetUKLocationByCounty>\r
         <!--Optional:-->\r
         <web:County>?</web:County>\r
      </web:GetUKLocationByCounty>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://www.webserviceX.NET/GetUKLocationByCounty"/><con:wsrmConfig version="1.2"/></con:call></con:operation><con:operation id="db116f0b-aade-4179-963d-1b6be8cfde74" isOneWay="false" action="http://www.webserviceX.NET/GetUKLocationByPostCode" name="GetUKLocationByPostCode" bindingOperationName="GetUKLocationByPostCode" type="Request-Response" inputName="" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="752382dc-f071-44f2-a2f7-2ed95a578554" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://www.webservicex.net/uklocation.asmx</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:web="http://www.webserviceX.NET">\r
   <soapenv:Header/>\r
   <soapenv:Body>\r
      <web:GetUKLocationByPostCode>\r
         <!--Optional:-->\r
         <web:PostCode>?</web:PostCode>\r
      </web:GetUKLocationByPostCode>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://www.webserviceX.NET/GetUKLocationByPostCode"/></con:call></con:operation><con:operation id="f4cd3faf-ace8-402c-83de-e76e38a0e60c" isOneWay="false" action="http://www.webserviceX.NET/GetUKLocationByTown" name="GetUKLocationByTown" bindingOperationName="GetUKLocationByTown" type="Request-Response" inputName="" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="506df284-c568-4b83-a3eb-ba2f151fc3cb" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://www.webservicex.net/uklocation.asmx</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:web="http://www.webserviceX.NET">\r
   <soapenv:Header/>\r
   <soapenv:Body>\r
      <web:GetUKLocationByTown>\r
         <!--Optional:-->\r
         <web:Town>?</web:Town>\r
      </web:GetUKLocationByTown>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://www.webserviceX.NET/GetUKLocationByTown"/><con:wsrmConfig version="1.2"/></con:call></con:operation><con:operation id="2b82c308-6814-4ca1-980d-65ffff2c7975" isOneWay="false" action="http://www.webserviceX.NET/ValidateUKAddress" name="ValidateUKAddress" bindingOperationName="ValidateUKAddress" type="Request-Response" inputName="" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="dba4d88a-d88f-4a6d-9817-528ea2c9b8ca" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://www.webservicex.net/uklocation.asmx</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:web="http://www.webserviceX.NET">\r
   <soapenv:Header/>\r
   <soapenv:Body>\r
      <web:ValidateUKAddress>\r
         <!--Optional:-->\r
         <web:Town>?</web:Town>\r
         <!--Optional:-->\r
         <web:County>?</web:County>\r
         <!--Optional:-->\r
         <web:PostCode>?</web:PostCode>\r
      </web:ValidateUKAddress>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://www.webserviceX.NET/ValidateUKAddress"/></con:call></con:operation></con:interface><con:testSuite id="afb0259b-7b9f-42ce-a880-c7972288b253" name="UKLocation-TestSuite"><con:settings/><con:runType>SEQUENTIAL</con:runType><con:testCase id="5fe11699-a1e8-406c-a297-6330db7f9509" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="UKLocation-TestCase" searchProperties="true"><con:settings/><con:testStep type="request" name="GetUKLocationByCounty" id="f6d429b7-0efb-4037-aee9-3301a6bf9a3f"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>UKLocationSoap</con:interface><con:operation>GetUKLocationByCounty</con:operation><con:request name="GetUKLocationByCounty" id="cb750be8-82b5-4b07-a500-1a318b6d9338"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://www.webservicex.net/uklocation.asmx</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:web="http://www.webserviceX.NET">
   <soapenv:Header/>
   <soapenv:Body>
      <web:GetUKLocationByCounty>
         <!--Optional:-->
         <web:County>oxford</web:County>
      </web:GetUKLocationByCounty>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="ae2f36d9-b3c6-4ab8-abeb-64a4142eaddc"/><con:assertion type="Simple Contains" id="b75d177e-ab62-41a5-8a2a-06eab27595c9" name="Contains"><con:configuration><token>Oxfordshire</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" id="9e4606dd-2f91-467d-ae6b-0b751af64688" name="Valid HTTP Status Codes"><con:configuration><codes>200</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="properties" name="PostCode" id="2421e468-ae63-4692-a9be-64fb8b7cf2b9"><con:settings/><con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:properties><con:property><con:name>postCode</con:name><con:value>OX15</con:value></con:property></con:properties></con:config></con:testStep><con:testStep type="request" name="GetUKLocationByPostCode" id="97e791db-28d0-4a62-b2af-93d912ac8d9b"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>UKLocationSoap</con:interface><con:operation>GetUKLocationByPostCode</con:operation><con:request name="GetUKLocationByPostCode" id="aaf11a13-b119-401f-96bc-b9fb3b2a086d"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://www.webservicex.net/uklocation.asmx</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:web="http://www.webserviceX.NET">
   <soapenv:Header/>
   <soapenv:Body>
      <web:GetUKLocationByPostCode>
         <web:PostCode>${PostCode#postCode}</web:PostCode>
      </web:GetUKLocationByPostCode>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="47200325-54eb-46c9-bdc8-fd4a67aff7df"/><con:assertion type="Simple Contains" id="7e3a8696-7c09-4168-9a3b-c9584f726031" name="Contains"><con:configuration><token>OX15</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" id="18423f91-5dfe-4fa8-ae82-aecd6a7e0791" name="Valid HTTP Status Codes"><con:configuration><codes>200</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="GetUKLocationByTown_ProjectLevel" id="8a46954c-a50b-4e71-a166-f497c234e15a"><con:settings/><con:config><script>import groovy.util.XmlSlurper

def responseContent = testRunner.testCase.getTestStepByName("GetUKLocationByPostCode").getPropertyValue("response")

log.info(responseContent)

def xmlResponse=new XmlSlurper().parseText(responseContent)

log.info(xmlResponse)

def slurperResponse=new XmlSlurper().parseText(xmlResponse.Body.GetUKLocationByPostCodeResponse.GetUKLocationByPostCodeResult.toString())

// Find town 'Clifton'
for(int i = 0; i &lt; slurperResponse.Table.size(); i++)
 {
 	if (slurperResponse.Table.Town[i].text() == "Clifton")
 	{
 		def TownName = slurperResponse.Table.Town[i].toString()
 		log.info(TownName)
 		
 		testRunner.testCase.testSuite.project.setPropertyValue("UKTown", TownName) 		
 	}
 }
</script></con:config></con:testStep><con:testStep type="request" name="GetUKLocationByTown" id="5f3c5c5b-6313-4a60-a235-9e73e84e5501"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>UKLocationSoap</con:interface><con:operation>GetUKLocationByTown</con:operation><con:request name="GetUKLocationByTown" id="ac7e9015-b4fb-4c24-8adb-cbd5a53f9837"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://www.webservicex.net/uklocation.asmx</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:web="http://www.webserviceX.NET">
   <soapenv:Header/>
   <soapenv:Body>
      <web:GetUKLocationByTown>
         <!--Optional:-->
         <web:Town>${#Project#Town}</web:Town>
      </web:GetUKLocationByTown>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="696f2f30-dc21-4510-8416-8d8331141627"/><con:assertion type="Simple Contains" id="35e92744-2514-4161-93c6-b0d93798fe34" name="Contains"><con:configuration><token>Clifton</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" id="9026994e-5b13-445d-9ae1-187df7cf78bb" name="Valid HTTP Status Codes"><con:configuration><codes>200</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="ValidateUKAddress_GlobalLevel" id="965c81b9-4373-4e79-8894-92d6cceea316"><con:settings/><con:config><script>import groovy.util.XmlSlurper

def responseContent = testRunner.testCase.getTestStepByName("GetUKLocationByTown").getPropertyValue("response")

log.info(responseContent)

def xmlResponse=new XmlSlurper().parseText(responseContent)

log.info(xmlResponse)

def slurperResponse=new XmlSlurper().parseText(xmlResponse.Body.GetUKLocationByTownResponse.GetUKLocationByTownResult.toString())

// Find data where town = Clifton, county = Bedfordshire and postcode = SG17
for(int i = 0; i &lt; slurperResponse.Table.size(); i++)
 {
 	if ((slurperResponse.Table.Town[i].text() == "Clifton") &amp;&amp; (slurperResponse.Table.County[i].text() == "Bedfordshire") &amp;&amp; (slurperResponse.Table.PostCode[i].text() == "SG17"))
 	{
 		def TownName = slurperResponse.Table.Town[i].toString()
 		log.info(TownName)

 		def CountyName = slurperResponse.Table.County[i].toString()
 		log.info(CountyName)
 		
 		def PostCode = slurperResponse.Table.PostCode[i].toString()
 		log.info(PostCode)
 		
		com.eviware.soapui.SoapUI.globalProperties.setPropertyValue("UKTown", TownName.toString())
		com.eviware.soapui.SoapUI.globalProperties.setPropertyValue("UKCounty", CountyName.toString())
		com.eviware.soapui.SoapUI.globalProperties.setPropertyValue("UKPostCode", PostCode.toString())
 	}
 }
</script></con:config></con:testStep><con:testStep type="request" name="ValidateUKAddress" id="416d0067-9eac-48aa-ad8a-f1e779de1e4e"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>UKLocationSoap</con:interface><con:operation>ValidateUKAddress</con:operation><con:request name="ValidateUKAddress" id="99449733-02d8-4de2-bb29-ab1150f54fa5"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://www.webservicex.net/uklocation.asmx</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:web="http://www.webserviceX.NET">
   <soapenv:Header/>
   <soapenv:Body>
      <web:ValidateUKAddress>
         <web:Town>${UKTown}</web:Town>
         <web:County>${UKCounty}</web:County>
         <web:PostCode>${UKPostCode}</web:PostCode>
      </web:ValidateUKAddress>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="cf032c2c-8e5d-44cd-8832-c601335d8f4d"/><con:assertion type="Simple Contains" id="cdc3d2eb-041a-4fe0-9669-d258bbdd9c7a" name="Contains_Country"><con:configuration><token>Bedfordshire</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="Simple Contains" id="ee53aaf5-c478-488a-bea6-a9115f6b6596" name="Contains_PC"><con:configuration><token>SG17</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" id="5a15dfa4-901e-42d8-9941-76d0d0604831" name="Valid HTTP Status Codes"><con:configuration><codes>200</codes></con:configuration></con:assertion><con:assertion type="Simple Contains" id="c7bef1d9-1378-45de-a0db-d7760874881f" name="Contains_Town"><con:configuration><token>Clifton</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:properties/></con:testCase><con:properties/></con:testSuite><con:properties><con:property><con:name>Town</con:name><con:value>Clifton</con:value></con:property><con:property><con:name>UKTown</con:name><con:value>Clifton</con:value></con:property></con:properties><con:wssContainer/><con:oAuth2ProfileContainer/><con:oAuth1ProfileContainer/></con:soapui-project>